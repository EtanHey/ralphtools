# Ralph Progress - v2 Skills + Bug Fixes

Started: Fri Jan 23 14:56:32 IST 2026

## Iteration 1 - US-032: Skills Discovery command (/skills)
**Status**: COMPLETED

Created `/skills` command that:
- Scans ~/.claude/commands/ for all installed skills
- Detects both single-file (.md) and multi-file (SKILL.md) formats
- Extracts descriptions from YAML frontmatter or first blockquote
- Groups skills by category (Infrastructure, Domain, Custom)
- Shows skill source (ralphtools, superpowers, ralph-config, custom)
- Counts workflows for progressive disclosure skills
- Supports --search keyword filtering

Files created:
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/skills.md
- Symlinked to ~/.claude/commands/skills.md

### Learnings
- Skills use YAML frontmatter with `name` and `description` fields
- Multi-file skills have SKILL.md at root with workflows/ subdirectory
- Source detection via symlink resolution (readlink -f)

## Iteration 2 - US-033: Linear skill (API wrapper)
**Status**: COMPLETED

Created `/linear` skill that replaces the need for Linear MCP:
- Uses curl with Linear's GraphQL API (https://api.linear.app/graphql)
- API key stored in 1Password, retrieved via `op read`
- Progressive disclosure architecture: SKILL.md router + 4 workflow files

Files created:
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/linear/SKILL.md - Router with quick actions table
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/linear/workflows/create-issue.md - Create issues with priority, labels, assignee
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/linear/workflows/list-issues.md - Query/filter/search issues
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/linear/workflows/update-issue.md - Update state, assignee, priority, add comments
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/linear/workflows/create-worktree.md - Create git worktree from Linear issue
- Symlinked to ~/.claude/commands/linear

### Learnings
- Linear API uses GraphQL at https://api.linear.app/graphql
- Auth: `Authorization: <API_KEY>` (no Bearer prefix for API keys)
- Linear auto-generates branch names for issues via `branchName` field
- Rate limit: 1,500 requests/hour with API key auth
- GraphQL returns 200 even on errors - always check `errors` array

## Iteration 3 - US-034: Convex skill (CLI wrapper)
**Status**: COMPLETED

Created `/convex` skill that wraps the npx convex CLI:
- Progressive disclosure architecture: SKILL.md router + 6 workflow files
- Auto-detects Convex project by checking for `convex/` directory
- Handles CONVEX_DEPLOY_KEY from 1Password for CI/CD production deploys

Files created:
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/convex/SKILL.md - Router with quick actions table
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/convex/workflows/dev.md - Start dev server with hot reload
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/convex/workflows/deploy.md - Production deployment with deploy key
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/convex/workflows/run-function.md - Execute queries, mutations, actions
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/convex/workflows/data-export.md - Export database to zip
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/convex/workflows/data-import.md - Import data with safety warnings
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/convex/workflows/schema.md - Schema inspection and validation
- Symlinked to ~/.claude/commands/convex

### Learnings
- Convex CLI commands: dev, deploy, run, export, import, codegen, env, dashboard
- Deploy key format: `prod:...` for production access
- Function path format: `filename:functionName` (no .ts extension)
- Always backup before import - import can overwrite data
- Schema changes can be destructive - export first

## Iteration 4 - US-036: Install Wizard skill
**Status**: COMPLETED

Created `/ralph-install` skill that guides new users through ralphtools setup:
- Progressive disclosure architecture: SKILL.md router + 5 workflow files
- Checks for all required CLIs (gh, op, gum, fswatch, jq, git)
- Guides brew installation of missing dependencies
- Helps configure API tokens in 1Password
- Creates skill symlinks in ~/.claude/commands/
- Validates entire installation end-to-end

Files created:
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/ralph-install/SKILL.md - Router with workflow table and troubleshooting
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/ralph-install/workflows/check-deps.md - Dependency verification scripts
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/ralph-install/workflows/install-deps.md - Homebrew installation guide
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/ralph-install/workflows/setup-tokens.md - 1Password token configuration
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/ralph-install/workflows/setup-symlinks.md - Skill symlink creation
- /Users/etanheyman/Desktop/Gits/ralphtools/skills/ralph-install/workflows/validate.md - Post-install validation
- Symlinked to ~/.claude/commands/ralph-install

### Learnings
- Install wizards benefit from step-by-step workflow separation
- Include troubleshooting in main SKILL.md for quick reference
- Validation scripts with pass/fail counts give clear status

## Iteration 5 - US-037: Separate notification channels (Ralph vs Claude)
**Status**: COMPLETED

Implemented separate ntfy topics for Ralph and Claude:
- Ralph topics are per-project: `etans-ralph-<project>` (same project shares topic)
- Claude topic is fixed: `etans-ralphClaude` (never mixes with Ralph)
- Added configurable prefix via RALPH_NTFY_PREFIX
- All Ralph notifications now include [Ralph] prefix in title

Files modified:
- /Users/etanheyman/Desktop/Gits/ralphtools/ralph.zsh - Updated defaults and notification function
- /Users/etanheyman/Desktop/Gits/ralphtools/docs/notifications.md - Created topic naming documentation

### Learnings
- Per-project topics allow subscribing only to active projects
- Fixed Claude topic ensures Claude alerts are never buried in Ralph iterations
- [Ralph] prefix in title makes notifications easily identifiable at a glance

## Iteration 6 - US-038: Session isolation via git worktree
**Status**: COMPLETED

Implemented worktree-based session isolation to keep Ralph from polluting main project's Claude /resume history:

Commands added:
- `ralph-start [args]` - Creates worktree at ~/worktrees/<repo>/ralph-session, outputs cd + ralph command
- `ralph-cleanup [--force]` - Merges changes back to main repo, removes worktree

How it works:
- Claude sessions are stored per-directory in ~/.claude/projects/
- Each directory path gets its own session storage
- Git worktrees create a linked copy at a different path
- Claude sees worktree as a separate project â†’ separate session history
- `/resume` in main project stays clean (no Ralph iterations)

Files created/modified:
- /Users/etanheyman/Desktop/Gits/ralphtools/ralph.zsh - Added ralph-start, ralph-cleanup, _ralph_output_worktree_command
- /Users/etanheyman/Desktop/Gits/ralphtools/docs/session-isolation.md - Full documentation
- /Users/etanheyman/Desktop/Gits/ralphtools/prd-json/AGENTS.md - Added worktree workflow section

### Learnings
- Claude sessions stored in ~/.claude/projects/ with path encoded (dashes replace slashes)
- Worktrees at different paths get completely separate session histories
- Must copy prd-json/ and progress.txt to worktree for Ralph to work
- ralph-cleanup syncs state back before removing worktree
- git worktree prune cleans up stale references
