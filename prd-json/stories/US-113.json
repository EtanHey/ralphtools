{
  "id": "US-113",
  "title": "Wire ralph to run under ralph-ui with node-pty",
  "description": "Implement the architecture from docs.local/live-ui-research: ralph-ui spawns Claude via node-pty, captures output with TTY semantics (colors, progress bars), and displays in Ink UI. The working terminal is 'hidden' under the reading terminal - user sees clean UI while Claude runs underneath.",
  "acceptanceCriteria": [
    {"text": "=== READ RESEARCH ===", "checked": false},
    {"text": "Read docs.local/live-ui-research/round-3-agent-9-synthesis.md fully", "checked": false},
    {"text": "Understand: node-pty wrapper, dual-output pipeline, PTY interface", "checked": false},
    {"text": "=== PHASE 1: PTY WRAPPER ===", "checked": false},
    {"text": "Install node-pty: bun add node-pty", "checked": false},
    {"text": "Create ralph-ui/src/runner/pty-wrapper.ts per research spec", "checked": false},
    {"text": "Implement PTYProcess interface (onData, onExit, kill, resize)", "checked": false},
    {"text": "Test: spawn claude command, capture colored output", "checked": false},
    {"text": "=== PHASE 2: DUAL OUTPUT ===", "checked": false},
    {"text": "Create ralph-ui/src/runner/dual-output.ts", "checked": false},
    {"text": "Display path: PassThrough with ANSI preserved", "checked": false},
    {"text": "File path: strip-ansi transform for clean logs", "checked": false},
    {"text": "Logs written to ~/.config/ralphtools/runs/{timestamp}/", "checked": false},
    {"text": "=== PHASE 3: UI INTEGRATION ===", "checked": false},
    {"text": "Wire PTY output to Ink <Static> component for scrolling logs", "checked": false},
    {"text": "Status bar shows current command, elapsed time", "checked": false},
    {"text": "Ctrl+C propagates to PTY for graceful termination", "checked": false},
    {"text": "=== PHASE 4: RALPH INTEGRATION ===", "checked": false},
    {"text": "ralph command spawns ralph-ui --run internally", "checked": false},
    {"text": "ralph-ui --run spawns Claude via node-pty", "checked": false},
    {"text": "User sees: clean Ink UI with live Claude output underneath", "checked": false},
    {"text": "=== VERIFICATION ===", "checked": false},
    {"text": "ralph 5 - runs 5 iterations, all output captured in UI", "checked": false},
    {"text": "Colors and progress bars display correctly", "checked": false},
    {"text": "Ctrl+C stops cleanly, no zombie processes", "checked": false},
    {"text": "Log file contains clean (ANSI-stripped) output", "checked": false},
    {"text": "Run CodeRabbit review - must pass (or create BUG if unfixable)", "checked": false},
    {"text": "Commit: feat: US-113 wire ralph under ralph-ui with node-pty", "checked": false}
  ],
  "dependencies": ["BUG-030"],
  "passes": false
}
