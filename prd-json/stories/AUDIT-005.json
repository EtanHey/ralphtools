{
  "id": "AUDIT-005",
  "title": "Machine-wide hardcoded secrets audit and migration to 1Password",
  "description": "Scan entire Mac for hardcoded API keys, tokens, and secrets in config files from the past year. Check 1Password first before creating new items. Migrate all secrets to appropriate vaults.",
  "acceptanceCriteria": [
    {"text": "=== DISCOVERY PHASE ===", "checked": true},
    {"text": "Scan ~/.claude/ for hardcoded keys (settings.json, .claude.json files)", "checked": true},
    {"text": "Scan ~/.config/ for API keys and tokens", "checked": true},
    {"text": "Scan ~/Gits/*/.env* files (not .env.template)", "checked": true},
    {"text": "Scan ~/Gits/*/.claude.json for MCP server secrets", "checked": true},
    {"text": "Scan ~/Gits/*/package.json for embedded tokens", "checked": true},
    {"text": "Document all findings in docs.local/audits/AUDIT-005-secrets.md", "checked": true},
    {"text": "=== VERIFICATION PHASE ===", "checked": true},
    {"text": "For each secret found, check if already in 1Password: op item list --tags api-key", "checked": true},
    {"text": "Check development vault for existing dev tool secrets", "checked": true},
    {"text": "Check project vaults (Domica, Cantaloupe, etc.) for project secrets", "checked": true},
    {"text": "Mark duplicates - don't create if already exists", "checked": true},
    {"text": "=== MIGRATION PHASE ===", "checked": false},
    {"text": "Create missing secrets in appropriate vaults with proper tags", "checked": false},
    {"text": "Replace hardcoded values with op:// references where supported", "checked": false},
    {"text": "Update .claude.json files to use op:// references", "checked": false},
    {"text": "Update .env files to .env.template with op:// references", "checked": false},
    {"text": "=== CLEANUP PHASE ===", "checked": false},
    {"text": "Remove plaintext secrets from config files", "checked": false},
    {"text": "Add .env to .gitignore if not present", "checked": false},
    {"text": "Verify all projects still work after migration", "checked": false},
    {"text": "Run CodeRabbit review - must pass (or create BUG if unfixable)", "checked": false},
    {"text": "Commit: chore: AUDIT-005 migrate hardcoded secrets to 1Password", "checked": false}
  ],
  "dependencies": [],
  "storyType": "AUDIT",
  "blockedBy": "1Password authentication timeout - user not present to authorize Touch ID"
}
