{
  "id": "US-105",
  "title": "Enhanced Ink UI: alive indicator, CodeRabbit status, error detection",
  "description": "## Implementation Approach\n\n### Status File Protocol\nralph.zsh writes status to /tmp/ralph-status-$$.json:\n```json\n{\"state\": \"running|cr_review|error|retry\", \"lastActivity\": 1234567890, \"error\": null, \"retryIn\": 0}\n```\n\n### Component Structure\n1. **AliveIndicator.tsx** - Spinner + 'last activity Xs ago' from lastActivity timestamp\n2. **CodeRabbitStatus.tsx** - Shows when state='cr_review'\n3. **ErrorBanner.tsx** - Red banner when state='error'\n4. **RetryCountdown.tsx** - Shows 'Retrying in Xs' when state='retry'\n5. **HangingWarning.tsx** - Yellow warning if >60s no activity",
  "type": "feature",
  "priority": "medium",
  "storyPoints": 5,
  "status": "pending",
  "acceptanceCriteria": [
    {"text": "=== STATUS FILE PROTOCOL ===", "checked": true},
    {"text": "Create _ralph_write_status() helper in ralph.zsh", "checked": true},
    {"text": "Write status file at /tmp/ralph-status-$$.json", "checked": true},
    {"text": "Update lastActivity timestamp on Claude output received", "checked": true},
    {"text": "Set state='cr_review' before cr review call, state='running' after", "checked": true},
    {"text": "Set state='error' with error message when error detected", "checked": true},
    {"text": "Set state='retry' with retryIn seconds during cooldown", "checked": true},
    {"text": "Clean up status file in cleanup_ralph() trap", "checked": true},
    {"text": "=== REACT INK COMPONENTS ===", "checked": true},
    {"text": "Create components/AliveIndicator.tsx with spinner + last activity", "checked": true},
    {"text": "Create components/CodeRabbitStatus.tsx for CR review state", "checked": true},
    {"text": "Create components/ErrorBanner.tsx for error display", "checked": true},
    {"text": "Create components/RetryCountdown.tsx for retry state", "checked": true},
    {"text": "Create components/HangingWarning.tsx (>60s no activity)", "checked": true},
    {"text": "Add useStatusFile hook to watch /tmp/ralph-status-$$.json", "checked": true},
    {"text": "Integrate all components into Dashboard.tsx", "checked": true},
    {"text": "=== TESTING ===", "checked": true},
    {"text": "Test: Status file created on ralph start", "checked": true},
    {"text": "Test: lastActivity updates during execution", "checked": true},
    {"text": "Test: CodeRabbit status shows during cr review", "checked": true},
    {"text": "Test: Error banner shows on API error", "checked": true},
    {"text": "Test: Hanging warning shows after 60s inactivity", "checked": true},
    {"text": "Commit changes", "checked": false}
  ],
  "dependencies": ["BUG-022", "US-106"],
  "passes": false
}
